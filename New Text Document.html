<!DOCTYPE HTML>
<html>
<head>
<link href="https://www.tucao.one/player_test/M_dplayer.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://jabbany.github.io/ABPlayerHTML5/dist/css/base.min.css" />
<script src="https://jabbany.github.io/ABPlayerHTML5/dist/vendor/CommentCoreLibrary.min.js"></script>
    <script src="file:///C:/Dropbox/Backup/Shortcut/Batch/greasemonkey/anime1/ABPlayerHTML5.js"></script>
</head>
<body>


<div id='load-player' class='abp'>
<video id="video-1" src="file:///C:/anime/Violet%20Evergarden/[%E7%B9%81]%20%E7%B4%AB%E7%BD%97%E5%85%B0%E6%B0%B8%E6%81%92%E8%8A%B1%E5%9B%AD%20[Extra_Episode]%20-%20EYNY.mp4"></video>
</div>
<script>
var abp=ABP.create(document.getElementById("load-player"), {
  "src":{
    "playlist":[
      {
        "video":document.getElementById("video-1"),
        "comments":`<?xml version="1.0" encoding="utf-8"?><i><d p='3.7,1,25,16777215,1580090422'>看看男主好不好被打爆</d>
<d p='61.6,1,25,16777215,1580090530'>武汉。。。</d>
<d p='504.9,1,25,16777215,1580090921'>还会打掉武器。。</d>
<d p='598.9,1,25,16777215,1580091053'>翻车</d>
<d p='707.5,1,25,16777215,1580091176'>这么水的吗</d>
<d p='367.2,1,25,16777215,1580098743'>为什么不火葬</d>
<d p='1315.1,1,25,16777215,1580105015'>赛博朋克</d>
<d p='430.4,1,25,16777215,1580106800'>好方便的设定</d>
<d p='897.1,1,25,16777215,1580107051'>这么少女心的吗？</d>
<d p='897.8,1,25,16777215,1580107062'>这番有点温暖啊</d>
<d p='18.8,1,25,16777215,1580113972'>.....</d>
<d p='1353.1,1,25,16777215,1580121156'>这算正式的ed了吧？</d>
<d p='341.6,1,25,16777215,1580123545'>设定不错</d>
<d p='924.1,1,25,16777215,1580129663'>蜥蜴头泡药酒</d>
<d p='404.8,1,25,16777215,1580131841'>生化2</d>
<d p='354.6,1,25,16777215,1580135353'>为啥不火葬</d>
<d p='804.9,1,25,16777215,1580135466'>不要停下来啊！</d>
<d p='1339.1,1,25,16777215,1580136114'>ED换了？</d>
<d p='1339.8,1,25,16777215,1580145724'>ed换了还行</d>
<d p='0,1,25,16777215,1580177791'>233</d>
<d p='23000,1,25,16777215,1580178028'>wwww</d>
</i>`}
    ]
  },
  "width":800,
  "height":522
});
//setTimeout(function(){alert(abp.video.currentTime);},10000);
abp.cmManager.options.scroll.scale=2;
    var ABP_Unit=document.querySelector("div.ABP-Unit");
    var ABP_Control=ABP_Unit.querySelector("div.ABP-Control");
    var ABP_Text=ABP_Unit.querySelector("div.ABP-Text");
    var ABP_Video=ABP_Unit.querySelector("div.ABP-Video");
    ABP_Video.onmousemove=function(){
    ABP_Control.style=" display: block;"
    ABP_Text.style=" display: block;"

    
    }
        var ABP_Text_Input=ABP_Text.querySelector('input');
        //insert danmaku setting ui
        dmSetIconBtnHtml=`
            <button data-balloon="Setting" data-balloon-pos="up" class="dplayer-icon dplayer-comment-setting-icon" style="height:30px;z-index:100;"><span class="dplayer-icon-content"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" version="1.1" viewBox="0 0 32 32"><path class="dplayer-fill" style="fill:#666;" d="M19.357 2.88c1.749 0 3.366 0.316 4.851 0.946 1.485 0.632 2.768 1.474 3.845 2.533s1.922 2.279 2.532 3.661c0.611 1.383 0.915 2.829 0.915 4.334 0 1.425-0.304 2.847-0.915 4.271-0.611 1.425-1.587 2.767-2.928 4.028-0.855 0.813-1.811 1.607-2.869 2.38s-2.136 1.465-3.233 2.075c-1.099 0.61-2.198 1.098-3.296 1.465-1.098 0.366-2.115 0.549-3.051 0.549-1.343 0-2.441-0.438-3.296-1.311-0.854-0.876-1.281-2.41-1.281-4.608 0-0.366 0.020-0.773 0.060-1.221s0.062-0.895 0.062-1.343c0-0.773-0.183-1.353-0.55-1.738-0.366-0.387-0.793-0.58-1.281-0.58-0.652 0-1.21 0.295-1.678 0.886s-0.926 1.23-1.373 1.921c-0.447 0.693-0.905 1.334-1.372 1.923s-1.028 0.886-1.679 0.886c-0.529 0-1.048-0.427-1.556-1.282s-0.763-2.259-0.763-4.212c0-2.197 0.529-4.241 1.587-6.133s2.462-3.529 4.21-4.912c1.75-1.383 3.762-2.471 6.041-3.264 2.277-0.796 4.617-1.212 7.018-1.253zM7.334 15.817c0.569 0 1.047-0.204 1.434-0.611s0.579-0.875 0.579-1.404c0-0.569-0.193-1.047-0.579-1.434s-0.864-0.579-1.434-0.579c-0.529 0-0.987 0.193-1.373 0.579s-0.58 0.864-0.58 1.434c0 0.53 0.194 0.998 0.58 1.404 0.388 0.407 0.845 0.611 1.373 0.611zM12.216 11.79c0.691 0 1.292-0.254 1.8-0.763s0.762-1.107 0.762-1.8c0-0.732-0.255-1.343-0.762-1.831-0.509-0.489-1.109-0.732-1.8-0.732-0.732 0-1.342 0.244-1.831 0.732-0.488 0.488-0.732 1.098-0.732 1.831 0 0.693 0.244 1.292 0.732 1.8s1.099 0.763 1.831 0.763zM16.366 25.947c0.692 0 1.282-0.214 1.77-0.64s0.732-0.987 0.732-1.678-0.244-1.261-0.732-1.709c-0.489-0.448-1.078-0.671-1.77-0.671-0.65 0-1.21 0.223-1.678 0.671s-0.702 1.018-0.702 1.709c0 0.692 0.234 1.25 0.702 1.678s1.027 0.64 1.678 0.64zM19.113 9.592c0.651 0 1.129-0.203 1.433-0.611 0.305-0.406 0.459-0.874 0.459-1.404 0-0.488-0.154-0.947-0.459-1.373-0.304-0.427-0.782-0.641-1.433-0.641-0.529 0-1.008 0.193-1.434 0.58s-0.64 0.865-0.64 1.434c0 0.571 0.213 1.049 0.64 1.434 0.427 0.389 0.905 0.581 1.434 0.581zM24.848 12.826c0.57 0 1.067-0.213 1.495-0.64 0.427-0.427 0.64-0.947 0.64-1.556 0-0.57-0.214-1.068-0.64-1.495-0.428-0.427-0.927-0.64-1.495-0.64-0.611 0-1.129 0.213-1.555 0.64-0.428 0.427-0.642 0.926-0.642 1.495 0 0.611 0.213 1.129 0.642 1.556s0.947 0.64 1.555 0.64z" id="dplayer-pallette"></path></svg></span></button>
        `;

        ABP_Text_Input.style='padding-left:50px';
        ABP_Text_Input.insertAdjacentHTML('beforeBegin', dmSetIconBtnHtml);
        dmSetBoxHtml=`
<div class="dplayer-controller dplayer-comment-setting-box" style="display:none;padding-bottom:30px;">
    <div class="dplayer-comment-setting-color">
        <div class="dplayer-comment-setting-title">Set danmaku color</div>
        <label>
            <input name="dplayer-danmaku-color-0" value="while" checked="" type="radio"><span style="background: #FFFFFF;width:22px;height:22px;display:inline-block;"></span></label>
        <label>
            <input name="dplayer-danmaku-color-0" value="red" type="radio"><span style="background: #E54256;width:22px;height:22px;display:inline-block;"></span></label>
        <label>
            <input name="dplayer-danmaku-color-0" value="yellow" type="radio"><span style="background: #FFE133;width:22px;height:22px;display:inline-block;"></span></label>
        <label>
            <input name="dplayer-danmaku-color-0" value="green" type="radio"><span style="background: #64DD17;width:22px;height:22px;display:inline-block;"></span></label>
        <label>
            <input name="dplayer-danmaku-color-0" value="blue" type="radio"><span style="background: #39ccff;width:22px;height:22px;display:inline-block;"></span></label>
        <label>
            <input name="dplayer-danmaku-color-0" value="purple" type="radio"><span style="background: #D500F9;width:22px;height:22px;display:inline-block;"></span></label>
    </div>
    <div class="dplayer-comment-setting-type">
        <div class="dplayer-comment-setting-title">Set danmaku type</div>
        <label>
            <input name="dplayer-danmaku-type-0" value="top" type="radio"><span>Top</span></label>
        <label>
            <input name="dplayer-danmaku-type-0" value="right" checked="" type="radio"><span>Rolling</span></label>
        <label>
            <input name="dplayer-danmaku-type-0" value="bottom" type="radio"><span>Bottom</span></label>
    </div>
    <div class="dplayer-comment-setting-size">
        <div class="dplayer-comment-setting-title">Set danmaku size</div>
        <label>
            <input name="dplayer-danmaku-size-0" value="25" checked="" type="radio"><span>Normal</span></label>
        <label>
            <input name="dplayer-danmaku-size-0" value="45" type="radio"><span>Big</span></label>
        <label>
            <input name="dplayer-danmaku-size-0" value="64" type="radio"><span>Max</span></label>
    </div>
</div>
        `;
        ABP_Text_Input.insertAdjacentHTML('beforeBegin', dmSetBoxHtml);
        var dmSetBox = ABP_Text.querySelector('div');
        var dmSetIconBtn = ABP_Text.querySelector('button');
        //dmSetBox.style="display:none";
        var toggleSetting=function () {
            if (dmSetBox.classList.contains('dplayer-comment-setting-open')) {
                dmSetBox.classList.remove('dplayer-comment-setting-open');
                dmSetBox.style.display="none";
            } else {
                dmSetBox.classList.add('dplayer-comment-setting-open');
                dmSetBox.style.display="block";
            }
        }
        var dmSettingApply=function(){
    		var color = dmSetBox.querySelector('div.dplayer-comment-setting-color').querySelector("input:checked").value;
        	var mode = dmSetBox.querySelector('div.dplayer-comment-setting-type').querySelector("input:checked").value;
        	var size = dmSetBox.querySelector('div.dplayer-comment-setting-size').querySelector("input:checked").value;
        	ABP_Text_Input.value=ABP_Text_Input.value.replace(/$|(\{\{([\w\d]*,[\w\d]*,[\w\d]*)\}\})/,'{{'+mode+','+size+','+color+'}}');
        }
        dmSetIconBtn.addEventListener('click',toggleSetting);
        dmSetBox.addEventListener('click',dmSettingApply);
    var ButtonFullscreen_ABP=ABP_Unit.querySelector("div.button.ABP-FullScreen");
    ButtonFullscreen_ABP.addEventListener("click",function (){
        ABP_Video.style.width=ABP_Unit.offsetWidth+"px";
        ABP_Video.style.height=ABP_Unit.offsetHeight+"px";
    });</script>

</body>
</html>